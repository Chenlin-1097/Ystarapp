# 扫码报工系统使用说明

## 系统概述

这是一个基于飞书多维表格的扫码报工管理系统，支持多工序报工、历史记录管理和权限控制。

## 快速开始

### 1. 安装和启动

```bash
# 安装依赖
npm install

# 启动开发环境
npm run electron-dev

# 打包生产版本
npm run electron-pack
```

### 2. 首次配置

1. 启动应用后，使用测试账号登录：
   - 用户名：`test`
   - 密码：`123456`

2. 点击右上角的"配置"按钮，打开配置向导

3. 按照向导步骤配置飞书表格信息

## 飞书表格准备

### 用户表格结构

创建一个飞书多维表格，包含以下字段：

| 字段名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| 用户名 | 文本 | 登录用户名 | `zhangsan` |
| 密码 | 文本 | 登录密码 | `123456` |
| 姓名 | 文本 | 用户真实姓名 | `张三` |
| 工序权限 | 文本 | 可操作的工序，逗号分隔 | `工序1,工序2,工序3` |

### 产品表格结构

创建产品数据表格，包含以下字段：

| 字段名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| 产品名称 | 文本 | 产品名称 | `iPhone 15` |
| 总数量 | 数字 | 产品总数量 | `100` |
| 已报工数量 | 数字 | 已完成报工的总数 | `45` |
| 二维码 | 文本 | 产品对应的二维码内容 | `PROD001` |
| 工序1报工数 | 数字 | 工序1的报工数量 | `20` |
| 工序2报工数 | 数字 | 工序2的报工数量 | `15` |
| 工序3报工数 | 数字 | 工序3的报工数量 | `10` |
| 工序4报工数 | 数字 | 工序4的报工数量 | `0` |

### 获取表格信息

1. 打开飞书多维表格
2. 在浏览器地址栏中找到 `app_token`：
   ```
   https://example.feishu.cn/base/bascnCMII2ORzjyIDTr57nu2n2d
   ```
   其中 `bascnCMII2ORzjyIDTr57nu2n2d` 就是 `app_token`

3. 点击表格标签，在地址栏中找到 `table_id`：
   ```
   https://example.feishu.cn/base/bascnCMII2ORzjyIDTr57nu2n2d/tblsRc9GRRXKqhvW
   ```
   其中 `tblsRc9GRRXKqhvW` 就是 `table_id`

## 系统使用

### 登录系统

1. 启动应用
2. 输入用户名和密码
3. 系统会验证用户权限并显示可操作的工序

### 扫码报工

1. **选择工序**：在下拉菜单中选择要报工的工序类型
2. **扫描二维码**：
   - 将光标放在扫码输入框中
   - 使用扫码枪扫描产品二维码
   - 系统会自动识别并处理
3. **查看结果**：
   - 右侧会显示产品信息
   - 报工成功后会更新数量统计
   - 历史记录中会添加新的报工记录

### 功能特性

#### 防重复扫码
- 2秒内扫描相同二维码会提示"请勿重复扫码"
- 避免误操作导致的重复报工

#### 网络状态监控
- 实时显示与飞书服务器的连接状态
- 网络断开时会提示并可手动重连

#### 报工撤销
- 在历史记录中点击"撤销"按钮
- 确认后会从飞书表格中删除对应记录

#### 权限控制
- 不同用户只能看到和操作授权的工序
- 系统会根据用户权限过滤工序选项

## 扫码枪配置

### 推荐设置
1. 将扫码枪设置为**键盘输入模式**
2. 确保扫码后自动回车（Enter键）
3. 如果扫码枪有前缀/后缀设置，建议清空

### 测试方法
1. 打开记事本或任意文本编辑器
2. 使用扫码枪扫描二维码
3. 确认能正常输出文本内容

## 常见问题

### Q: 登录失败怎么办？
A: 
1. 检查网络连接状态
2. 确认用户表格配置正确
3. 验证用户名密码是否正确
4. 查看控制台错误信息

### Q: 扫码没有反应？
A: 
1. 确认已选择工序类型
2. 检查扫码枪是否正常工作
3. 确认二维码内容长度大于5个字符
4. 检查产品表格中是否存在对应记录

### Q: 网络连接失败？
A: 
1. 检查网络连接
2. 确认飞书API访问权限
3. 验证App ID和App Secret是否正确
4. 点击"重连"按钮重新连接

### Q: 报工数据不同步？
A: 
1. 检查表格权限设置
2. 确认字段名称映射正确
3. 查看飞书表格是否有写入权限
4. 重启应用重新连接

## 技术支持

如遇到其他问题，请：
1. 查看浏览器控制台错误信息
2. 检查飞书开放平台应用配置
3. 联系技术支持团队

## 更新日志

### v1.0.0
- ✅ 基础框架搭建
- ✅ 用户登录验证
- ✅ 扫码报工功能
- ✅ 报工历史记录
- ✅ 网络状态监控
- ✅ 配置向导界面

### 待开发功能
- 🔄 表格上传功能
- 🔄 数据导出功能
- 🔄 报表统计
- 🔄 多语言支持 